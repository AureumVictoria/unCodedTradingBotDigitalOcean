# .do/deploy.template.yaml
spec:
  name: trading-bot-app

  workers:
    - name: trading-bot
      instance_size_slug: apps-s-1vcpu-0.5gb   # $5 shared tier
      instance_count: 1
      image:
        registry_type: DOCKER_HUB
        registry: aureumvictoria
        repository: uncoded-trading-bot
        tag: "2025.09.09"
      envs:
        - key: POSTGRES_HOST
          scope: RUN_TIME
          value: "${db.HOSTNAME}"
        - key: POSTGRES_PORT
          scope: RUN_TIME
          value: "${db.PORT}"
        - key: POSTGRES_DB
          scope: RUN_TIME
          value: "${db.DATABASE}"
        - key: POSTGRES_USER
          scope: RUN_TIME
          value: "${db.USERNAME}"
        - key: POSTGRES_PASSWORD
          scope: RUN_TIME
          value: "${db.PASSWORD}"
        - key: DATABASE_URL
          scope: RUN_TIME
          value: "${db.DATABASE_URL}"

        - key: API_KEY
          scope: RUN_TIME
          type: SECRET
        - key: API_SECRET
          scope: RUN_TIME
          type: SECRET
        - key: DOCKER_ENV
          scope: RUN_TIME
          value: "true"

    - name: telegram-bot
      instance_size_slug: apps-s-1vcpu-0.5gb   # $5 shared tier
      instance_count: 1
      image:
        registry_type: DOCKER_HUB
        registry: aureumvictoria
        repository: uncoded-telegram-bot
        tag: "2025.09.09"
      envs:
        - key: POSTGRES_HOST
          scope: RUN_TIME
          value: "${db.HOSTNAME}"
        - key: POSTGRES_PORT
          scope: RUN_TIME
          value: "${db.PORT}"
        - key: POSTGRES_DB
          scope: RUN_TIME
          value: "${db.DATABASE}"
        - key: POSTGRES_USER
          scope: RUN_TIME
          value: "${db.USERNAME}"
        - key: POSTGRES_PASSWORD
          scope: RUN_TIME
          value: "${db.PASSWORD}"
        - key: DATABASE_URL
          scope: RUN_TIME
          value: "${db.DATABASE_URL}"

        - key: TELEGRAM_TOKEN
          scope: RUN_TIME
          type: SECRET
        - key: DOCKER_ENV
          scope: RUN_TIME
          value: "true"

  databases:
    - name: db
      engine: PG
      version: "16"
      production: false   # 1-Klick unterst√ºtzt Dev-DB
